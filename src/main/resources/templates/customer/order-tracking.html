<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{customer/layout}">
<head>
<meta charset="UTF-8">
<title>Theo d√µi ƒë∆°n h√†ng</title>

<th:block layout:fragment="styles">
	<link rel="stylesheet" href="/styles/css/customer/order-tracking.css">
	<link rel="stylesheet" href="/styles/css/customer/account-sidebar.css">
	<link rel="stylesheet" href="/styles/css/customer/base.css">
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
</th:block>
</head>

<body>
	<div layout:fragment="content">
		<div class="account-layout">

			<!-- üîπ Sidebar -->
			<div th:replace="~{customer/fragments/account-sidebar :: sidebar}"></div>

			<!-- üîπ N·ªôi dung ch√≠nh -->
			<div class="account-content">
				<div class="order-page">

					<!-- Tabs tr·∫°ng th√°i -->
					<div class="tabs">
						<a th:href="@{/customer/orders(status='tatca')}" class="tab"
							th:classappend="${selectedStatus}=='tatca' ? 'active'">T·∫•t c·∫£</a>

						<a th:href="@{/customer/orders(status='new')}" class="tab"
							th:classappend="${selectedStatus}=='new' ? 'active'">M·ªõi</a> <a
							th:href="@{/customer/orders(status='pending')}" class="tab"
							th:classappend="${selectedStatus}=='pending' ? 'active'">Ch·ªù
							x·ª≠ l√Ω</a> <a th:href="@{/customer/orders(status='confirmed')}"
							class="tab"
							th:classappend="${selectedStatus}=='confirmed' ? 'active'">ƒê√£
							x√°c nh·∫≠n</a> <a th:href="@{/customer/orders(status='shipping')}"
							class="tab"
							th:classappend="${selectedStatus}=='shipping' ? 'active'">ƒêang
							giao</a> <a th:href="@{/customer/orders(status='delivered')}"
							class="tab"
							th:classappend="${selectedStatus}=='delivered' ? 'active'">Ho√†n
							t·∫•t</a> <a th:href="@{/customer/orders(status='returned_refunded')}"
							class="tab"
							th:classappend="${selectedStatus}=='returned_refunded' ? 'active'">Tr·∫£
							h√†ng</a> <a th:href="@{/customer/orders(status='canceled')}"
							class="tab"
							th:classappend="${selectedStatus}=='canceled' ? 'active'">ƒê√£
							h·ªßy</a>
					</div>


					<!-- ‚úÖ Kh√¥ng c√≥ ƒë∆°n -->
					<div th:if="${#lists.isEmpty(orders)}" class="empty-orders">
						<img src="/styles/image/icons/empty-order.png" alt="No orders">
						<p>Ch∆∞a c√≥ ƒë∆°n h√†ng</p>
					</div>

					<!-- ‚úÖ C√≥ ƒë∆°n -->
					<div th:each="order : ${orders}" class="order-card">
						<div class="order-header">
							<span>M√£ ƒë∆°n: <b th:text="${order.id}"></b></span> <span
								class="status" th:text="${order.status.displayName}"></span>

						</div>

						<!-- Chi ti·∫øt s·∫£n ph·∫©m -->
						<div th:each="item : ${order.orderDetails}" class="order-item">
							<a th:href="@{'/product/' + ${item.product.id}}"> <img
								th:src="@{${item.product.images[0].imageUrl}}"
								alt="·∫¢nh s·∫£n ph·∫©m" class="clickable-image">
							</a>

							<div class="info">
								<p>
									<a th:href="@{'/product/' + ${item.product.id}}"
										th:text="${item.product.productName}" class="product-link"></a>
								</p>
								<p>
									S·ªë l∆∞·ª£ng: <span th:text="${item.quantity}"></span>
								</p>
							</div>

							<div class="price">
								<span
									th:text="${#numbers.formatDecimal(item.promotionalPrice != null ? item.promotionalPrice : item.price,0,'COMMA',0,'POINT')} + ' ‚Ç´'"></span>
							</div>
						</div>

						<!-- T·ªïng & h√†nh ƒë·ªông -->
						<div class="order-footer">
							<p>
								T·ªïng ti·ªÅn: <b
									th:text="${#numbers.formatDecimal(order.amountFromCustomer,0,'COMMA',0,'POINT')} + ' ‚Ç´'"></b>
							</p>
							<div class="actions">
								<a th:href="@{/customer/orders/{id}(id=${order.id})}"
									class="view-detail">Xem chi ti·∫øt</a>

								<!-- H·ªßy ƒë∆°n -->
								<form th:if="${order.status.name() == 'PENDING'}"
									th:action="@{/customer/orders/{id}/cancel(id=${order.id})}"
									method="post" style="display: inline;">
									<button type="submit" class="btn-cancel"
										onclick="return confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë∆°n n√†y ch·ª©?');">
										H·ªßy ƒë∆°n</button>
								</form>
							</div>
						</div>

						<!-- N·∫øu ƒë∆°n ƒë√£ ho√†n t·∫•t -->
						<div class="actions" th:if="${order.status.name() == 'DELIVERED'}">
							<button type="button" class="btn-review"
								th:data-order-id="${order.id}" onclick="openReviewPopup(this)">
								<i class="fa fa-star"></i> ƒê√°nh gi√°
							</button>

							<form th:action="@{/customer/orders/{id}/return(id=${order.id})}"
								method="post" style="display: inline;"
								onsubmit="return confirm('X√°c nh·∫≠n tr·∫£ h√†ng cho ƒë∆°n #'+[[${order.id}]]+'?');">
								<button type="submit" class="btn-return">
									<i class="fa fa-undo"></i> Tr·∫£ h√†ng
								</button>
							</form>
						</div>
					</div>

				</div>
			</div>
		</div>

		<!-- üîπ Popup ƒê√°nh gi√° -->
		<div id="reviewModal" class="review-modal hidden">
			<div class="review-modal-content">
				<span class="close-btn" onclick="closeReviewPopup()">&times;</span>
				<h2>ƒê√°nh gi√° s·∫£n ph·∫©m</h2>

				<form id="reviewForm" method="post">
					<input type="hidden" id="orderId" name="orderId">

					<div class="radio" style="margin-bottom: 14px;">
						<input id="rating-5" type="radio" name="rating" value="5" /> <label
							for="rating-5" title="5 sao"> <svg viewBox="0 0 576 512"
								width="32" height="32" xmlns="http://www.w3.org/2000/svg">
      <path
									d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
    </svg>
						</label> <input id="rating-4" type="radio" name="rating" value="4" /> <label
							for="rating-4" title="4 sao"> <svg viewBox="0 0 576 512"
								width="32" height="32" xmlns="http://www.w3.org/2000/svg">
      <path
									d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
    </svg>
						</label> <input id="rating-3" type="radio" name="rating" value="3" /> <label
							for="rating-3" title="3 sao"> <svg viewBox="0 0 576 512"
								width="32" height="32" xmlns="http://www.w3.org/2000/svg">
      <path
									d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
    </svg>
						</label> <input id="rating-2" type="radio" name="rating" value="2" /> <label
							for="rating-2" title="2 sao"> <svg viewBox="0 0 576 512"
								width="32" height="32" xmlns="http://www.w3.org/2000/svg">
      <path
									d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
    </svg>
						</label> <input id="rating-1" type="radio" name="rating" value="1" /> <label
							for="rating-1" title="1 sao"> <svg viewBox="0 0 576 512"
								width="32" height="32" xmlns="http://www.w3.org/2000/svg">
      <path
									d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
    </svg>
						</label>
					</div>

					<textarea name="comment" placeholder="Vi·∫øt c·∫£m nh·∫≠n c·ªßa b·∫°n..."
						required></textarea>

					<button type="submit" class="btn-submit">G·ª≠i ƒë√°nh gi√°</button>
				</form>
			</div>
		</div>
	</div>

	<th:block layout:fragment="scripts">
		<script src="/styles/js/customer/header.js"></script>
		<script th:src="@{/styles/js/customer/avatar.js}"></script>
		<script src="/styles/js/customer/account-sidebar.js"></script>
		<script src="/styles/js/customer/review.js"></script>
	</th:block>
</body>
</html>
