<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="/styles/css/customer/base.css">
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap"
      rel="stylesheet">
</head>
<body>
  <div th:fragment="header">
    <header>
      <div class="header-top">
        <!-- üîπ Logo -->
        <div class="logo">
          <a th:href="@{/home}" class="logo-link">
            <img src="/styles/image/logo.png" alt="Logo">
            <span class="shop-name">4Petals Flower Shop</span>
          </a>
        </div>

        <!-- üîπ T√¨m ki·∫øm -->
        <form th:action="@{/product}" method="get" class="search-form">
          <div class="search-box">
            <input type="text" name="q" th:value="${keyword}" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..." />
            <button type="submit"><i class="fa fa-search"></i></button>
          </div>
        </form>

        <!-- üîπ User actions -->
        <div class="user-actions">
          <!-- Khi CH∆ØA ƒëƒÉng nh·∫≠p -->
          <a th:href="@{/login}" sec:authorize="isAnonymous()">
            <i class="fa-solid fa-right-to-bracket"></i> <strong>ƒêƒÉng nh·∫≠p</strong>
          </a>
          <a th:href="@{/register}" sec:authorize="isAnonymous()">
            <i class="fa-solid fa-user-plus"></i> <strong>ƒêƒÉng k√Ω</strong>
          </a>

          <!-- Gi·ªè h√†ng ·∫©n khi ch∆∞a ƒëƒÉng nh·∫≠p -->
          <a href="#" sec:authorize="isAnonymous()" class="cart-icon disabled"
             title="Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ s·ª≠ d·ª•ng gi·ªè h√†ng" style="display: none;">
             <i class="fa-solid fa-cart-shopping"></i> Gi·ªè h√†ng
          </a>

          <!-- Khi ƒê√É ƒëƒÉng nh·∫≠p -->
          <div sec:authorize="isAuthenticated()">
            <!-- Ch·ªâ hi·ªÉn th·ªã gi·ªè h√†ng cho CUSTOMER -->
            <a th:href="@{/cart}" class="cart-icon" sec:authorize="hasRole('CUSTOMER')">
              <i class="fa-solid fa-cart-shopping"></i>
              <span id="cart-count" class="cart-count" style="display: none;">0</span>
            </a>

            <span class="welcome">
              Xin ch√†o,
              <strong th:text="${user != null && user.userProfile != null && user.userProfile.fullName != null 
                               ? user.userProfile.fullName 
                               : #authentication.name}">
                User
              </strong>
            </span>

            <!-- üîπ Menu ng∆∞·ªùi d√πng -->
            <div class="user-menu">
              <div class="avatar" id="avatar-btn">
                <!-- N·∫øu c√≥ avatar -->
                <img th:if="${user != null and user.avatar != null}"
                     th:src="${user.avatar}" alt="Avatar" class="avatar-img">

                <!-- N·∫øu kh√¥ng c√≥ avatar -->
                <img th:if="${user == null or user.avatar == null}"
                     src="/styles/image/customer/default-avatar.png"
                     alt="Avatar" class="avatar-img">
              </div>

              <div class="dropdown" id="user-dropdown">
                <a th:href="@{/account}"><i class="fa-solid fa-user"></i> T√†i kho·∫£n</a>
                <a th:href="@{/customer/orders}"><i class="fa-solid fa-box"></i> ƒê∆°n mua</a>
                <a th:href="@{/logout}"><i class="fa-solid fa-right-from-bracket"></i> ƒêƒÉng xu·∫•t</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- üîπ Menu ch√≠nh -->
      <nav class="header-nav">
        <ul class="nav-links">
          <li><a th:href="@{/home}"><i class="fa-solid fa-house"></i> Trang ch·ªß</a></li>
          <li><a th:href="@{/product}"><i class="fa-solid fa-box-open"></i> S·∫£n ph·∫©m</a></li>
          <li><a th:href="@{/about}"><i class="fa-solid fa-circle-info"></i> Gi·ªõi thi·ªáu</a></li>
          <li><a th:href="@{/contact}"><i class="fa-solid fa-envelope"></i> Li√™n h·ªá</a></li>
        </ul>
      </nav>
    </header>
  </div>
</body>
</html>
