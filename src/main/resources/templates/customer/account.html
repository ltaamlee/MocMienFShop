<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{customer/layout}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4Petals - T√†i kho·∫£n</title>

<th:block layout:fragment="styles">
	<link rel="stylesheet" href="/styles/css/customer/base.css">
	<link rel="stylesheet" href="/styles/css/customer/account.css">
	<link rel="stylesheet" href="/styles/css/customer/account-sidebar.css">
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
</th:block>
</head>
<body>
	<div layout:fragment="content">
		<main class="account-page">
			<section class="container account-container">
				<div class="account-layout">

					<!-- Sidebar -->
					<div th:replace="~{customer/fragments/account-sidebar :: sidebar}"></div>

					<!-- N·ªôi dung ch√≠nh -->
					<div class="account-content">
						<h2>H·ªì s∆° c√° nh√¢n</h2>
						<div class="profile-section">

							<!-- C·ªôt b√™n tr√°i: Avatar -->
							<div class="profile-avatar">
								<div class="avatar-frame">
									<img
										th:src="@{${user.avatar != null ? user.avatar : '/styles/image/customer/default-avatar.png'}}"
										alt="Avatar" id="avatar-preview">
								</div>
								<form method="post" enctype="multipart/form-data"
									th:action="@{/account/avatar/upload}">
									<input type="file" id="avatar-input" name="file"
										accept="image/*" style="display: none;">
									<div class="avatar-buttons">
										<button type="button" class="btn-upload"
											onclick="document.getElementById('avatar-input').click()">T·∫£i
											·∫£nh m·ªõi</button>
									</div>
								</form>

								<!-- ‚úÖ Popup xem tr∆∞·ªõc ·∫£nh -->
								<div id="preview-popup" class="preview-popup"
									style="display: none;">
									<div class="preview-overlay" onclick="closePreviewPopup()"></div>
									<div class="preview-box">
										<button class="close-btn" onclick="closePreviewPopup()">&times;</button>
										<h3>Xem tr∆∞·ªõc ·∫£nh ƒë·∫°i di·ªán</h3>
										<div class="preview-image-wrapper">
											<img id="preview-image" src="" alt="Xem tr∆∞·ªõc">
										</div>
										<div class="preview-actions">
											<button id="confirm-upload" class="btn-save">L∆∞u</button>
										</div>
									</div>
								</div>
							</div>

							<!-- Th√¥ng tin ng∆∞·ªùi d√πng -->
							<div class="profile-info">
								<div class="info-display">
									<div class="form-group">
										<label>H·ªç v√† t√™n:</label> <input type="text"
											id="display-fullName" readonly
											th:value="${user.userProfile.fullName}">
									</div>

									<div class="form-group">
										<label>Ng√†y sinh:</label> <input type="text" id="display-dob"
											readonly th:value="${user.userProfile.dob}">
									</div>

									<div class="form-group">
										<label>Gi·ªõi t√≠nh:</label> <input type="text"
											id="display-gender" readonly
											th:value="${user.userProfile.gender}">
									</div>

									<div class="form-group">
										<label>Email:</label> <input type="email" id="display-email"
											readonly th:value="${user.email}">
									</div>

									<div class="form-group">
										<label>S·ªë ƒëi·ªán tho·∫°i:</label> <input type="text"
											id="display-phone" readonly th:value="${user.phone}">
									</div>

									<div class="form-group">
										<label>ƒêi·ªÉm t√≠ch l≈©y:</label> <input type="text"
											id="display-point" readonly
											th:value="${user.userProfile.point}">
									</div>

									<div class="form-group">
										<label>S·ªë d∆∞ v√≠:</label> <input type="text"
											id="display-ewallet" readonly
											th:value="${user.userProfile.eWallet}">
									</div>
								</div>

								<button type="button" id="btn-edit-info" class="btn-edit">
									C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n</button>
							</div>

							<!-- Popup s·ª≠a th√¥ng tin -->
							<div id="editInfoPopup" class="popup-overlay">
								<div class="popup-content popup-wide">
									<button class="close-btn" onclick="closeEditPopup()">&times;</button>
									<h3>Ch·ªânh s·ª≠a th√¥ng tin c√° nh√¢n</h3>

									<form id="editInfoForm" th:action="@{/account/update}"
										method="post">
										<!-- üßç‚Äç‚ôÄÔ∏è H·ªç v√† t√™n -->
										<div class="form-group">
											<label>H·ªç v√† t√™n:</label> <input type="text"
												id="edit-fullName" name="fullName"
												th:value="${user.userProfile.fullName}" required>
										</div>

										<!-- üìÖ Ng√†y sinh -->
										<div class="form-group">
											<label>Ng√†y sinh:</label> <input type="date" id="edit-dob"
												name="dob" th:value="${user.userProfile.dob}">
										</div>

										<!-- üöª Gi·ªõi t√≠nh -->
										<div class="form-group">
											<label>Gi·ªõi t√≠nh:</label> <select id="edit-gender"
												name="gender">
												<option value="Nam"
													th:selected="${user.userProfile.gender == 'Nam'}">Nam</option>
												<option value="N·ªØ"
													th:selected="${user.userProfile.gender == 'N·ªØ'}">N·ªØ</option>
												<option value="Kh√°c"
													th:selected="${user.userProfile.gender == 'Kh√°c'}">Kh√°c</option>
											</select>
										</div>

										<!-- üìß Email -->
										<div class="form-group">
											<label>Email:</label> <input type="email" id="edit-email"
												name="email" th:value="${user.email}" readonly>
										</div>

										<!-- üìû S·ªë ƒëi·ªán tho·∫°i -->
										<div class="form-group">
											<label>S·ªë ƒëi·ªán tho·∫°i:</label> <input type="text"
												id="edit-phone" name="phone" th:value="${user.phone}">
										</div>


										<!-- üí∞ S·ªë d∆∞ v√≠ -->
										<div class="form-group">
											<label>S·ªë d∆∞ v√≠ (E-Wallet):</label> <input type="text"
												id="edit-ewallet" name="eWallet"
												th:value="${user.userProfile.eWallet}" readonly>
										</div>

										<!-- ‚≠ê ƒêi·ªÉm t√≠ch l≈©y -->
										<div class="form-group">
											<label>ƒêi·ªÉm t√≠ch l≈©y:</label> <input type="text"
												id="edit-point" name="point"
												th:value="${user.userProfile.point}" readonly>
										</div>

										<div class="popup-buttons" style="justify-content: center;">
											<button type="submit" class="btn-save">L∆∞u thay ƒë·ªïi</button>
										</div>
									</form>

								</div>
							</div>

						</div>
					</div>
			</section>
		</main>
	</div>

	<th:block layout:fragment="scripts">
		<script src="/styles/js/customer/header.js"></script>
		<script src="/styles/js/customer/account-sidebar.js"></script>
		<script src="/styles/js/customer/avatar.js"></script>
		<script src="/styles/js/customer/info.js"></script>
	</th:block>

</body>
</html>
